---
title: "p8105_hw2_gwk2111"
author: "Zach Keefer"
date: "9/30/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

##Problem 1

Read in data from the NYC transit subway entrance and exit data csv file, along with snaked variable names and entry converted from character to logical:

```{r}
nyc_transit_data = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, route1:route11, entrance_type, entry, vending, ada) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))

nyc_transit_data
```

This dataset that I created has 15 character variables, two double variables, and two logical variables.  The double variables refer to station latitude and longitude, while the character and logical variables are used to characterize each observation.  Most notably, there are 11 different character variables for route.  To clean this data I read in the file, used janitor to make more usable variable names, selected the 19 variables as instructed and then changed the entry variable from character to logical.  This dataset has 1,868 rows and 19 columns.  As stated before, there are 11 variables to describe route with many observations left empty. As a result, before gathering, this data set is not tidy.


There are `r nrow(distinct(nyc_transit_data, line, station_name, ada))` distinct stations in the data set.  `r nrow(distinct(subset(nyc_transit_data, ada == TRUE), line, station_name, ada))` of these stations are ADA compliant.  The proportion of entrance/exits that don't have vending that do allow entry is `r nrow(filter(nyc_transit_data, entry == TRUE, vending == "NO")) / nrow(filter(nyc_transit_data, vending == "NO"))`.


```{r}

##This code gathers the data and makes route number qnd route name two distinct variable, as opposed to having 11 route variables.
nyc_transit_data_route_reformat = gather(nyc_transit_data, key = route_number, value = route_name, route1:route11)

```

There are `r nrow(distinct(subset(nyc_transit_data_route_reformat, route_name == "A"), line, station_name, route_name))` stations that serve the A train.  Of the stations that serve the A train, `r (nrow(distinct(filter(nyc_transit_data_route_reformat, route_name == "A", ada == "TRUE"), line, station_name, route_name, ada)))` are ADA compliant.  


##Problem 2

Mr. Trash Wheel Sheet
```{r}
library(readxl)

mr_trash_wheel_data = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N258") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(sports_balls = as.integer(sports_balls)) 
```

2016 and 2017 Precipitation Data
```{r}
prcp_2016 = readxl::read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2016 Precipitation", range = "A2:B14") %>% 
  janitor::clean_names() %>%
  mutate(year = 2016)

prcp_2017 = readxl::read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2017 Precipitation", range = "A2:B14") %>% 
  janitor::clean_names() %>%
  filter(!is.na(total)) %>% 
  mutate(year = 2017)

prcp_2016_2017 = full_join(prcp_2016, prcp_2017) %>% 
  mutate(month = month.name[month])
```

`r nrow(mr_trash_wheel_data)`
`r nrow(prcp_2016_2017)`
`r sum(prcp_2017$total)`
`r median(pull(filter(mr_trash_wheel_data, year == 2016), sports_balls), sports_balls, na.rm = TRUE)`

##Problem 3
```{r}
library(p8105.datasets)

brfss_data = brfss_smart2010 %>% 
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>% 
  select(-class, -topic, -question, -sample_size, -(confidence_limit_low:geo_location)) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>% 
  mutate(prop_exc_vgood = excellent + very_good)
```

`r n_distinct(brfss_data$locationabbr, brfss_data$locationdesc)`
`r n_distinct(brfss_data$locationabbr)`
`r table(brfss_data$locationabbr)`
```{r}
filter(brfss_data, year == 2002) %>% 
  pull(excellent) %>% 
  median(excellent, na.rm = TRUE)

filter(brfss_data, year == 2002) %>% 
  ggplot(aes(x = excellent)) +
  geom_histogram()


filter(brfss_data, locationdesc == "NY - Queens County" | locationdesc == "NY - New York County") %>% 
  ggplot(aes(x = year, y = excellent, color = locationdesc)) +
  geom_point()
```

